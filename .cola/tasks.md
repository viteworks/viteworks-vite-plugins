# 任务规则

本文件定义了自动化任务的执行规范。在处理任何特定任务时，都必须严格遵循此处列出的步骤和要求。

---

## 任务 1: 提交代码

**目标**: 结合本次修改，生成带图标的提交信息，并在确认后提交代码，最后推送到远程分支。

**执行步骤**:

1.  运行 `git status` 和 `git diff HEAD` 分析暂存区和工作区的代码变更。
2.  根据代码变更，使用以下模板草拟一条带图标的提交信息 (例如 `feat: ✨ 添加新功能` 或 `fix: 🐛 修复Bug`)。提交信息必须使用中文描述：

    ```
    <type>(<scope>): <subject>

    ### 🚀 变更概述

    [这里填写对变更的简要描述，说明变更的目的和背景。]

    ### 主要变更

    - 🎯 [详细说明第一个主要变更点]
    - 🎯 [详细说明第二个主要变更点]
    - 🎯 [其他相关变更]
    ```

    - **type**: 提交类型 (如 `feat`, `fix`, `docs`, `style`, `refactor`, `test`, `chore`)。
    - **scope**: 可选的作用域 (如 `components`, `hooks`, `docs`)。
    - **subject**: 简短的变更描述。

3.  向用户展示草拟的提交信息，并请求确认。
4.  在用户确认后，执行 `git add .` 将所有更改添加到暂存区。
5.  执行 `git commit -m "..."` 使用商定的信息进行提交。
6.  执行 `git push` 将代码推送到当前的远程分支。

---

## 任务 2: 发布 Patch 版本

**目标**: 添加 Patch 版本的 changeset，触发 CI 自动发布流程。

**执行步骤**:

1.  运行 `git status --porcelain` 检查是否存在未提交的变更。
2.  如果存在未提交的变更，则提示并执行 **任务 1: 提交代码** 的流程。
3.  向用户确认是否要发布一个补丁 (Patch) 版本。
4.  运行 `git log --oneline -10` 和 `git diff HEAD~1` 分析最近的代码变更。
5.  根据代码变更自动生成中文变更描述，包括：
    - 主要功能变更或修复内容
    - 影响的模块或组件
    - 用户可感知的改进点
    - 格式示例："修复了插件配置解析问题，提升了构建性能"
6.  向用户展示生成的变更描述，并请求确认或修改。
7.  运行 `pnpm changeset add` 添加变更说明：
    - 选择需要更新的包（通常是所有有变更的包）
    - 选择版本类型为 `patch`
    - 使用生成的中文变更描述
8.  运行 `git add .` 将 changeset 文件添加到暂存区。
9.  运行 `git commit -m "chore: 📦 添加 patch 版本 changeset"` 提交 changeset。
10. 运行 `git push` 推送到远程 main 分支，触发 CI 自动发布流程。

---

## 任务 3: 发布 Major 版本

**目标**: 将最新的代码变更发布为一个主 (Major) 版本。

**执行步骤**:

1.  运行 `git status --porcelain` 检查是否存在未提交的变更。
2.  如果存在未提交的变更，则提示并执行 **任务 1: 提交代码** 的流程。
3.  向用户确认是否要发布一个主 (Major) 版本。

---

## 任务 4: 发布 Minor 版本

**目标**: 将最新的代码变更发布为一个次 (Minor) 版本。

**执行步骤**:

1.  运行 `git status --porcelain` 检查是否存在未提交的变更。
2.  如果存在未提交的变更，则提示并执行 **任务 1: 提交代码** 的流程。
3.  向用户确认是否要发布一个次 (Minor) 版本。

---

## 任务 5: 发布 Alpha 版本

**目标**: 将最新的代码变更发布为一个预发布 (Alpha) 版本。

**执行步骤**:

1.  运行 `git status --porcelain` 检查是否存在未提交的变更。
2.  如果存在未提交的变更，则提示并执行 **任务 1: 提交代码** 的流程。
3.  向用户确认是否要发布一个预发布 (Alpha) 版本。

---

## 任务 6: 发布文档

**目标**: 将最新的文档变更发布。

**执行步骤**:

1.  运行 `git status --porcelain` 检查是否存在未提交的变更。
2.  如果存在未提交的变更，则提示并执行 **任务 1: 提交代码** 的流程。
3.  向用户确认是否要发布文档。

---
